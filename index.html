<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Crypto Mastery Quiz</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #1f1c2c, #928dab);
    color: #eee;
    margin: 0; padding: 0;
    display: flex; justify-content: center; align-items: center;
    height: 100vh;
    direction: ltr;
  }
  body.rtl {
    direction: rtl;
    font-family: 'Arial', sans-serif;
  }
  #quiz-container {
    background: rgba(30, 30, 40, 0.95);
    border-radius: 12px;
    box-shadow: 0 0 20px #5f7aebaa;
    max-width: 800px;
    width: 95%;
    padding: 30px;
    text-align: center;
  }
  h1 {
    margin-bottom: 10px;
    color: #7d90ff;
  }
  #question {
    font-size: 1.3rem;
    margin: 20px 0;
    min-height: 80px;
  }
  .option {
    background: #393c59;
    margin: 10px 0;
    padding: 12px 20px;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.3s, transform 0.2s;
  }
  .option:hover {
    background: #5860ff;
    transform: scale(1.05);
  }
  .correct {
    background: #3cba54 !important;
  }
  .wrong {
    background: #db4437 !important;
  }
  #score, #progress, #timer {
    margin-top: 20px;
    font-size: 1.1rem;
  }
  #next-btn {
    margin-top: 25px;
    background: #7d90ff;
    border: none;
    color: #fff;
    padding: 12px 25px;
    font-size: 1rem;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.3s;
  }
  #next-btn:disabled {
    background: #555;
    cursor: not-allowed;
  }
  #next-btn:hover:enabled {
    background: #4e5edd;
  }
  #lang-select {
    margin-bottom: 20px;
    font-size: 1rem;
    padding: 6px 12px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
  }
</style>
</head>
<body>
<div id="quiz-container">
  <select id="lang-select" aria-label="Select Language">
    <option value="en">🇬🇧 English</option>
    <option value="ar">🇸🇦 العربية</option>
  </select>
  <h1 id="quiz-title">Crypto Mastery Quiz</h1>
  <div id="question">Loading question...</div>
  <div id="options"></div>
  <div id="timer"></div>
  <button id="next-btn" disabled>Next</button>
  <div id="progress"></div>
  <div id="score"></div>
</div>

<audio id="sound-correct" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>
<audio id="sound-wrong" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"></audio>

<script>
(() => {
  const questionsData = {
    en: [
      {question:"What does a zk-SNARK provide in blockchain?",options:["Privacy-preserving zero-knowledge proof","A mining reward system","A type of wallet","Staking contract"],answer:"Privacy-preserving zero-knowledge proof"},
      {question:"What is a flash loan attack?",options:["Manipulating DeFi via instant loans","Mining pool overload","Gas fee manipulation","NFT duplication"],answer:"Manipulating DeFi via instant loans"},
      {question:"What is the main function of Chainlink?",options:["Providing oracles for smart contracts","Hosting NFTs","Staking service","Layer 2 scaling"],answer:"Providing oracles for smart contracts"},
      {question:"What is a Merkle Tree used for in blockchain?",options:["Efficient data verification","Token minting","Smart contract execution","Reward calculation"],answer:"Efficient data verification"},
      {question:"What is slippage in crypto trading?",options:["Difference between expected and actual price","Gas fee delay","Token inflation","Liquidity pool bug"],answer:"Difference between expected and actual price"},
      {question:"What does DeFi stand for?",options:["Decentralized Finance","Digital Finance","Distributed File","Direct Funding"],answer:"Decentralized Finance"},
      {question:"What is a DAO?",options:["Decentralized Autonomous Organization","Digital Asset Option","Data Access Object","Decentralized Algorithmic Oracle"],answer:"Decentralized Autonomous Organization"},
      {question:"What is the purpose of a smart contract?",options:["Self-executing contract on blockchain","Legal contract scanned","Crypto wallet","Mining hardware"],answer:"Self-executing contract on blockchain"},
      {question:"What does ‘staking’ mean in crypto?",options:["Locking tokens to support network and earn rewards","Mining coins","Trading rapidly","Buying NFTs"],answer:"Locking tokens to support network and earn rewards"},
      {question:"Which consensus algorithm uses ‘proof of work’?",options:["Bitcoin","Ethereum 2.0","Cardano","Polkadot"],answer:"Bitcoin"},
      {question:"What is a ‘nonce’ in blockchain mining?",options:["A number used once to vary the hash","A type of wallet","A smart contract","A token standard"],answer:"A number used once to vary the hash"},
      {question:"What is the function of a ‘hash’ in blockchain?",options:["Data fingerprint for integrity","Token exchange rate","Gas fee","Wallet address"],answer:"Data fingerprint for integrity"},
      {question:"What is ‘liquidity mining’?",options:["Providing liquidity to DeFi pools for rewards","Mining bitcoins","Token burning","NFT auction"],answer:"Providing liquidity to DeFi pools for rewards"},
      {question:"What are ERC-20 tokens?",options:["Ethereum fungible tokens standard","Bitcoin tokens","NFT standard","DeFi loan tokens"],answer:"Ethereum fungible tokens standard"},
      {question:"What does ‘gas fee’ mean?",options:["Payment to miners for transaction processing","Penalty fee","Staking fee","Token price"],answer:"Payment to miners for transaction processing"},
      {question:"What is a ‘cold wallet’?",options:["Offline cryptocurrency wallet","Hot wallet","Exchange account","Smart contract"],answer:"Offline cryptocurrency wallet"},
      {question:"What is ‘impermanent loss’?",options:["Loss from providing liquidity due to price changes","Permanent wallet hack","Mining failure","Failed transaction"],answer:"Loss from providing liquidity due to price changes"},
      {question:"What is a ‘hashrate’?",options:["Mining power per second","Wallet balance","Token supply","Gas limit"],answer:"Mining power per second"},
      {question:"What does NFT stand for?",options:["Non-Fungible Token","New Financial Transaction","Network File Transfer","Node Functional Token"],answer:"Non-Fungible Token"},
      {question:"What is a ‘51% attack’?",options:["Control of majority mining power to manipulate blockchain","Slashing penalty","Token inflation","Smart contract bug"],answer:"Control of majority mining power to manipulate blockchain"},
      {question:"What does ‘fork’ mean in blockchain?",options:["Network split creating two versions","Token swap","Wallet backup","Mining hardware upgrade"],answer:"Network split creating two versions"},
      {question:"What is ‘yield farming’?",options:["Earning rewards by lending or staking crypto","Mining yield","Token creation","Wallet backup"],answer:"Earning rewards by lending or staking crypto"},
      {question:"What is a ‘token burn’?",options:["Permanently removing tokens from circulation","Creating new tokens","Transferring tokens","Smart contract upgrade"],answer:"Permanently removing tokens from circulation"},
      {question:"What is the ‘mainnet’?",options:["The primary blockchain network","Test network","Wallet","Smart contract"],answer:"The primary blockchain network"},
      {question:"What is a ‘layer 2’ solution?",options:["Scalability solution built on top of main blockchain","New blockchain","Mining pool","Crypto exchange"],answer:"Scalability solution built on top of main blockchain"}
    ],
    ar: [
      {question:"ما وظيفة zk-SNARK في البلوكشين؟",options:["إثبات الخصوصية دون كشف البيانات","نظام مكافآت تعدين","نوع من المحافظ","عقد التخزين"],answer:"إثبات الخصوصية دون كشف البيانات"},
      {question:"ما هو هجوم القرض اللحظي (Flash Loan)؟",options:["التلاعب بمنصات DeFi عبر قروض فورية","زيادة الحمل على التعدين","التحكم في رسوم الغاز","تكرار NFT"],answer:"التلاعب بمنصات DeFi عبر قروض فورية"},
      {question:"ما الدور الرئيسي لـ Chainlink؟",options:["توفير بيانات من الواقع للعقود الذكية","استضافة NFTs","خدمة Staking","حلول توسيع Layer 2"],answer:"توفير بيانات من الواقع للعقود الذكية"},
      {question:"ما وظيفة Merkle Tree في البلوكشين؟",options:["التحقق من البيانات بكفاءة","سك التوكنات","تشغيل العقود الذكية","حساب المكافآت"],answer:"التحقق من البيانات بكفاءة"},
      {question:"ما المقصود بـ Slippage في التداول؟",options:["فرق السعر المتوقع والفعلي","تأخير رسوم الغاز","تضخم التوكن","خلل في تجمع السيولة"],answer:"فرق السعر المتوقع والفعلي"},
      {question:"ماذا تعني DeFi؟",options:["التمويل اللامركزي","التمويل الرقمي","ملف موزع","تمويل مباشر"],answer:"التمويل اللامركزي"},
      {question:"ما هو DAO؟",options:["منظمة مستقلة لامركزية","خيار أصول رقمية","كائن وصول بيانات","أوراكل لامركزي"],answer:"منظمة مستقلة لامركزية"},
      {question:"ما وظيفة العقد الذكي؟",options:["عقد ينفذ ذاتيًا على البلوكشين","عقد قانوني ممسوح","محفظة كريبتو","أجهزة تعدين"],answer:"عقد ينفذ ذاتيًا على البلوكشين"},
      {question:"ماذا يعني الـ Staking في الكريبتو؟",options:["حجز توكنات لدعم الشبكة والحصول على مكافآت","تعدين العملات","تداول سريع","شراء NFTs"],answer:"حجز توكنات لدعم الشبكة والحصول على مكافآت"},
      {question:"أي خوارزمية توافق تستخدم إثبات العمل؟",options:["بيتكوين","إيثيريوم 2.0","كاردانو","بولكادوت"],answer:"بيتكوين"},
      {question:"ما هو الـ nonce في التعدين؟",options:["رقم يستخدم مرة واحدة لتغيير الهاش","نوع محفظة","عقد ذكي","معيار توكن"],answer:"رقم يستخدم مرة واحدة لتغيير الهاش"},
      {question:"ما وظيفة الـ hash في البلوكشين؟",options:["بصمة بيانات للتحقق","سعر صرف التوكن","رسوم الغاز","عنوان المحفظة"],answer:"بصمة بيانات للتحقق"},
      {question:"ما هو تعدين السيولة؟",options:["توفير السيولة في منصات DeFi مقابل مكافآت","تعدين بيتكوين","حرق التوكن","مزاد NFT"],answer:"توفير السيولة في منصات DeFi مقابل مكافآت"},
      {question:"ما هي توكنات ERC-20؟",options:["معيار توكنات قابلة للاستبدال على إيثيريوم","توكنات بيتكوين","معيار NFTs","توكنات قروض DeFi"],answer:"معيار توكنات قابلة للاستبدال على إيثيريوم"},
      {question:"ما معنى رسوم الغاز؟",options:["دفع للمنقبين لمعالجة المعاملات","رسوم جزائية","رسوم التخزين","سعر التوكن"],answer:"دفع للمنقبين لمعالجة المعاملات"},
      {question:"ما هي المحفظة الباردة؟",options:["محفظة غير متصلة بالإنترنت","محفظة ساخنة","حساب منصة تداول","عقد ذكي"],answer:"محفظة غير متصلة بالإنترنت"},
      {question:"ما هو الخسارة المؤقتة (Impermanent Loss)؟",options:["خسارة من توفير السيولة بسبب تغير السعر","اختراق دائم للمحفظة","فشل تعدين","معاملة فاشلة"],answer:"خسارة من توفير السيولة بسبب تغير السعر"},
      {question:"ما هو معدل الهاش (Hashrate)؟",options:["قوة التعدين في الثانية","رصيد المحفظة","عرض التوكن","حد الغاز"],answer:"قوة التعدين في الثانية"},
      {question:"ما معنى NFT؟",options:["توكن غير قابل للاستبدال","معاملة مالية جديدة","نقل ملف الشبكة","توكن وظيفي للعقد"],answer:"توكن غير قابل للاستبدال"},
      {question:"ما هو هجوم 51%؟",options:["السيطرة على غالبية قوة التعدين للتلاعب بالبلوكشين","عقوبة القطع","تضخم التوكن","خلل في العقد الذكي"],answer:"السيطرة على غالبية قوة التعدين للتلاعب بالبلوكشين"},
      {question:"ما معنى Fork في البلوكشين؟",options:["انقسام الشبكة لإنشاء نسختين","تبديل التوكن","نسخة احتياطية للمحفظة","ترقية أجهزة التعدين"],answer:"انقسام الشبكة لإنشاء نسختين"},
      {question:"ما هو الزراعة العائدية (Yield Farming)؟",options:["كسب مكافآت من الإقراض أو الحجز","تعدين العائد","إنشاء توكن","نسخة احتياطية للمحفظة"],answer:"كسب مكافآت من الإقراض أو الحجز"},
      {question:"ما هو حرق التوكن (Token Burn)؟",options:["إزالة التوكنات من التداول بشكل دائم","إنشاء توكنات جديدة","نقل التوكنات","ترقية العقد الذكي"],answer:"إزالة التوكنات من التداول بشكل دائم"},
      {question:"ما هي الشبكة الرئيسية (Mainnet)؟",options:["الشبكة الأساسية للبلوكشين","شبكة اختبار","محفظة","عقد ذكي"],answer:"الشبكة الأساسية للبلوكشين"},
      {question:"ما هو حل الطبقة الثانية (Layer 2)؟",options:["حل تحسين التوسع مبني على الشبكة الأساسية","بلوكشين جديد","تجمع تعدين","منصة تداول"],answer:"حل تحسين التوسع مبني على الشبكة الأساسية"}
    ]
  };

  let lang = 'en';
  let currentQuestionIndex = 0;
  let score = 0;
  let timerInterval = null;
  let timeLeft = 10;
  let unansweredQuestions = [];
  let answeredQuestions = [];
  let questions = [];
  
  const quizTitle = document.getElementById('quiz-title');
  const questionEl = document.getElementById('question');
  const optionsEl = document.getElementById('options');
  const timerEl = document.getElementById('timer');
  const nextBtn = document.getElementById('next-btn');
  const progressEl = document.getElementById('progress');
  const scoreEl = document.getElementById('score');
  const langSelect = document.getElementById('lang-select');
  const soundCorrect = document.getElementById('sound-correct');
  const soundWrong = document.getElementById('sound-wrong');
  const body = document.body;

  function startQuiz() {
    currentQuestionIndex = 0;
    score = 0;
    unansweredQuestions = [];
    answeredQuestions = [];
    questions = [...questionsData[lang]];
    updateDirection();
    quizTitle.textContent = lang === 'en' ? "Crypto Mastery Quiz" : "اختبار إتقان الكريبتو";
    scoreEl.textContent = '';
    nextBtn.disabled = true;
    showQuestion();
    updateProgress();
  }

  function updateDirection() {
    if (lang === 'ar') {
      body.classList.add('rtl');
    } else {
      body.classList.remove('rtl');
    }
  }

  function showQuestion() {
    resetState();
    if (currentQuestionIndex >= questions.length) {
      // Check unanswered and repeat
      if (unansweredQuestions.length > 0) {
        questions = unansweredQuestions;
        unansweredQuestions = [];
        currentQuestionIndex = 0;
        showQuestion();
        updateProgress();
        return;
      }
      showResults();
      return;
    }

    const q = questions[currentQuestionIndex];
    questionEl.textContent = q.question;

    q.options.forEach(optionText => {
      const option = document.createElement('div');
      option.classList.add('option');
      option.textContent = optionText;
      option.addEventListener('click', () => selectAnswer(option, q.answer));
      optionsEl.appendChild(option);
    });

    timeLeft = 10;
    timerEl.textContent = (lang === 'en' ? 'Time Left: ' : 'الوقت المتبقي: ') + timeLeft + 's';
    nextBtn.disabled = true;

    timerInterval = setInterval(() => {
      timeLeft--;
      timerEl.textContent = (lang === 'en' ? 'Time Left: ' : 'الوقت المتبقي: ') + timeLeft + 's';
      if (timeLeft <= 0) {
        clearInterval(timerInterval);
        markUnanswered();
        nextBtn.disabled = false;
        nextBtn.focus();
      }
    }, 1000);

    updateProgress();
  }

  function resetState() {
    clearInterval(timerInterval);
    nextBtn.disabled = true;
    optionsEl.innerHTML = '';
    timerEl.textContent = '';
  }

  function selectAnswer(selectedOption, correctAnswer) {
    clearInterval(timerInterval);
    nextBtn.disabled = false;
    const options = Array.from(optionsEl.children);
    options.forEach(option => {
      option.removeEventListener('click', selectAnswer);
      if (option.textContent === correctAnswer) {
        option.classList.add('correct');
      }
    });
    if (selectedOption.textContent === correctAnswer) {
      selectedOption.classList.add('correct');
      score++;
      soundCorrect.play();
    } else {
      selectedOption.classList.add('wrong');
      soundWrong.play();
    }
    answeredQuestions.push(questions[currentQuestionIndex]);
  }

  function markUnanswered() {
    // Mark correct option green and disable others
    const q = questions[currentQuestionIndex];
    const options = Array.from(optionsEl.children);
    options.forEach(option => {
      option.removeEventListener('click', selectAnswer);
      if (option.textContent === q.answer) {
        option.classList.add('correct');
      }
    });
    unansweredQuestions.push(q);
  }

  function updateProgress() {
    progressEl.textContent = (lang === 'en' ? `Question ${currentQuestionIndex + 1} of ${questions.length}` : `السؤال ${currentQuestionIndex + 1} من ${questions.length}`);
    scoreEl.textContent = (lang === 'en' ? `Score: ${score}` : `النقاط: ${score}`);
  }

  function showResults() {
    questionEl.textContent = lang === 'en' ? "Quiz Completed!" : "انتهى الاختبار!";
    optionsEl.innerHTML = '';
    timerEl.textContent = '';
    progressEl.textContent = '';
    scoreEl.textContent = (lang === 'en' ? `Final Score: ${score} / ${questionsData[lang].length}` : `النتيجة النهائية: ${score} من ${questionsData[lang].length}`);
    nextBtn.textContent = lang === 'en' ? "Restart Quiz" : "إعادة الاختبار";
    nextBtn.disabled = false;
    nextBtn.focus();
    currentQuestionIndex = -1;
  }

  nextBtn.addEventListener('click', () => {
    if (currentQuestionIndex === -1) {
      // Restart
      nextBtn.textContent = lang === 'en' ? "Next" : "التالي";
      startQuiz();
      return;
    }
    currentQuestionIndex++;
    showQuestion();
  });

  langSelect.addEventListener('change', e => {
    lang = e.target.value;
    nextBtn.textContent = lang === 'en' ? "Next" : "التالي";
    startQuiz();
  });

  // Initialize
  startQuiz();
})();
</script>
</body>
</html>
