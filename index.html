<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Crypto IQ Game</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(to bottom, #0f2027, #203a43, #2c5364);
    color: #fff;
    margin: 0; padding: 0;
    transition: direction 0.5s;
  }
  .container {
    max-width: 700px;
    margin: 40px auto;
    padding: 20px;
    background: #1e2a38;
    border-radius: 15px;
    box-shadow: 0 0 15px rgba(0,0,0,0.5);
    text-align: center;
  }
  h1 {
    color: #00ffff;
    font-weight: 700;
    margin-bottom: 15px;
  }
  .language-switch {
    margin-bottom: 20px;
  }
  button.lang-btn {
    padding: 10px 20px;
    margin: 0 10px 15px 10px;
    font-size: 1.1rem;
    cursor: pointer;
    border: none;
    border-radius: 8px;
    background-color: #00bcd4;
    color: white;
    font-weight: 700;
    transition: background 0.3s;
  }
  button.lang-btn:hover {
    background-color: #0097a7;
  }
  #start-btn {
    background-color: #4caf50;
    margin-bottom: 25px;
  }
  #start-btn:hover {
    background-color: #388e3c;
  }
  .question {
    font-size: 1.3rem;
    margin: 20px 0 15px 0;
    font-weight: 700;
  }
  .answers {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
    margin-bottom: 15px;
  }
  .answers button {
    padding: 12px;
    font-size: 1.1rem;
    font-weight: 600;
    border: none;
    border-radius: 10px;
    background-color: #00796b;
    color: white;
    cursor: pointer;
    text-align: left;
    transition: background-color 0.3s;
  }
  .answers button:hover {
    background-color: #004d40;
  }
  .timer {
    font-size: 1.2rem;
    color: #ffd700;
    margin-bottom: 10px;
  }
  .progress {
    font-size: 1rem;
    margin-bottom: 10px;
    font-weight: 600;
  }
  #result {
    font-size: 1.4rem;
    margin-top: 25px;
    font-weight: 700;
    color: #00ff00;
  }
  #monkey-img {
    margin: 15px auto;
    width: 150px;
    height: 150px;
    user-select: none;
  }
  #music-control {
    margin-top: 10px;
    cursor: pointer;
    font-weight: 700;
    background: #00bcd4;
    border: none;
    padding: 8px 16px;
    border-radius: 8px;
    color: white;
    font-size: 1rem;
  }
</style>
</head>
<body>
<div class="container" id="container">
  <h1 id="game-title">Crypto IQ Game</h1>
  <div class="language-switch">
    <button class="lang-btn" id="btn-en">English</button>
    <button class="lang-btn" id="btn-ar">العربية</button>
  </div>
  <button id="start-btn">Start Game</button>
  <div id="quiz" style="display:none;">
    <div class="timer" id="timer"></div>
    <div class="progress" id="progress"></div>
    <div class="question" id="question"></div>
    <div class="answers" id="answers"></div>
    <img id="monkey-img" src="" alt="Monkey" />
    <button id="music-control">Pause Music</button>
  </div>
  <div id="result"></div>
</div>

<!-- Sounds -->
<audio id="correctSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_5fb8b80fd6.mp3?filename=correct-2-46134.mp3"></audio>
<audio id="wrongSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_e0d40862c8.mp3?filename=wrong-answer-126515.mp3"></audio>
<audio id="bgMusic" src="https://cdn.pixabay.com/download/audio/2022/10/23/audio_42ef6e73f7.mp3?filename=epic-cinematic-music-background-12315.mp3" loop></audio>

<script>
  const questions = {
    en: [
      { q: "What does 'blockchain' refer to?", a: "A distributed ledger technology", options: ["A distributed ledger technology", "A type of cryptocurrency", "A data compression method", "A malware detection tool"] },
      { q: "What is the main purpose of a smart contract?", a: "Automate and enforce contract terms", options: ["Automate and enforce contract terms", "Create NFTs", "Encrypt email", "Replace fiat currency"] },
      { q: "What is Bitcoin's maximum supply?", a: "21 million", options: ["21 million", "100 million", "Unlimited", "1 million"] },
      { q: "What does 'NFT' stand for?", a: "Non-Fungible Token", options: ["Non-Fungible Token", "New Financial Technology", "Network Function Token", "Non-Fiction Text"] },
      { q: "Which algorithm does Bitcoin use for mining?", a: "SHA-256", options: ["SHA-256", "MD5", "RSA", "AES"] },
      { q: "What is a 'wallet' in cryptocurrency?", a: "A tool to store crypto keys", options: ["A tool to store crypto keys", "A bank account", "A type of exchange", "A cryptocurrency"] },
      { q: "Which one is a decentralized exchange?", a: "Uniswap", options: ["Uniswap", "Coinbase", "Binance", "Kraken"] },
      { q: "What is a 'fork' in blockchain?", a: "A split in the blockchain", options: ["A split in the blockchain", "A new coin", "A type of malware", "A wallet feature"] },
      { q: "Which crypto is known as digital gold?", a: "Bitcoin", options: ["Bitcoin", "Ethereum", "Ripple", "Litecoin"] },
      { q: "What is DeFi?", a: "Decentralized Finance", options: ["Decentralized Finance", "Digital Finance", "Distributed File system", "Direct Funding"] },
      { q: "What is the unit of Ethereum?", a: "Ether", options: ["Ether", "Bitcoin", "Ripple", "Token"] },
      { q: "What is staking?", a: "Locking crypto to earn rewards", options: ["Locking crypto to earn rewards", "Trading crypto", "Sending crypto", "Mining crypto"] },
      { q: "What is a 'token'?", a: "A digital asset on a blockchain", options: ["A digital asset on a blockchain", "A physical coin", "A bank note", "A password"] },
      { q: "What does 'ICO' stand for?", a: "Initial Coin Offering", options: ["Initial Coin Offering", "International Crypto Organization", "Internal Crypto Order", "Internet Coin Option"] },
      { q: "What is a hash function?", a: "A function that maps data to fixed size", options: ["A function that maps data to fixed size", "A password", "An encryption tool", "A token"] },
      { q: "Which platform is famous for smart contracts?", a: "Ethereum", options: ["Ethereum", "Bitcoin", "Ripple", "Litecoin"] },
      { q: "What is 'gas' in Ethereum?", a: "Fee to execute transactions", options: ["Fee to execute transactions", "Type of token", "A wallet", "A contract"] },
      { q: "What is mining?", a: "Validating transactions and adding to blockchain", options: ["Validating transactions and adding to blockchain", "Sending crypto", "Storing crypto", "Trading crypto"] },
      { q: "What is 'Cold Wallet'?", a: "Offline crypto storage", options: ["Offline crypto storage", "Online exchange", "Hot wallet", "Mobile wallet"] },
      { q: "What does 'DeFi' eliminate?", a: "Intermediaries", options: ["Intermediaries", "Transactions", "Smart contracts", "Tokens"] },
      { q: "What is a 'block'?", a: "Batch of transactions recorded", options: ["Batch of transactions recorded", "A wallet", "A type of token", "A cryptocurrency"] },
      { q: "Who invented Bitcoin?", a: "Satoshi Nakamoto", options: ["Satoshi Nakamoto", "Vitalik Buterin", "Elon Musk", "Charlie Lee"] },
      { q: "What is 'Liquidity' in crypto?", a: "Ease of buying/selling assets", options: ["Ease of buying/selling assets", "Value of token", "Crypto wallet", "Token supply"] },
      { q: "What is an 'exchange'?", a: "Platform to trade cryptocurrencies", options: ["Platform to trade cryptocurrencies", "Crypto wallet", "Blockchain", "Mining pool"] },
      { q: "What is 'Tokenomics'?", a: "Economics of tokens", options: ["Economics of tokens", "Type of token", "Wallet feature", "Blockchain concept"] }
    ],
    ar: [
      { q: "ما هو البلوكشين؟", a: "تقنية دفتر الأستاذ الموزع", options: ["تقنية دفتر الأستاذ الموزع", "عملة رقمية", "طريقة ضغط بيانات", "برنامج لمكافحة الفيروسات"] },
      { q: "ما الهدف الرئيسي من العقد الذكي؟", a: "تنفيذ شروط العقد تلقائياً", options: ["تنفيذ شروط العقد تلقائياً", "إنشاء NFT", "تشفير البريد الإلكتروني", "استبدال العملة الورقية"] },
      { q: "ما هو الحد الأقصى لعملة بيتكوين؟", a: "21 مليون", options: ["21 مليون", "100 مليون", "غير محدود", "1 مليون"] },
      { q: "ماذا يعني مصطلح NFT؟", a: "رمز غير قابل للاستبدال", options: ["رمز غير قابل للاستبدال", "تقنية مالية جديدة", "رمز وظيفة الشبكة", "نص غير خيالي"] },
      { q: "أي خوارزمية يستخدمها تعدين البيتكوين؟", a: "SHA-256", options: ["SHA-256", "MD5", "RSA", "AES"] },
      { q: "ما هو المحفظة في عالم العملات الرقمية؟", a: "أداة لتخزين مفاتيح التشفير", options: ["أداة لتخزين مفاتيح التشفير", "حساب بنكي", "نوع من البورصة", "عملة رقمية"] },
      { q: "أي من المنصات تعتبر بورصة لامركزية؟", a: "Uniswap", options: ["Uniswap", "Coinbase", "Binance", "Kraken"] },
      { q: "ما هو الفُرع في البلوكشين؟", a: "انقسام في سلسلة الكتل", options: ["انقسام في سلسلة الكتل", "عملة جديدة", "نوع من البرامج الضارة", "ميزة محفظة"] },
      { q: "أي عملة تُعرف بالذهب الرقمي؟", a: "بيتكوين", options: ["بيتكوين", "إيثريوم", "ريبل", "لايتكوين"] },
      { q: "ما هو التمويل اللامركزي (DeFi)؟", a: "تمويل لامركزي", options: ["تمويل لامركزي", "تمويل رقمي", "نظام ملفات موزع", "تمويل مباشر"] },
      { q: "ما هو وحدة إيثريوم؟", a: "إيثر", options: ["إيثر", "بيتكوين", "ريبل", "رمز"] },
      { q: "ما هو الستيكينج؟", a: "قفل العملات لكسب مكافآت", options: ["قفل العملات لكسب مكافآت", "تداول العملات", "إرسال العملات", "تعدين العملات"] },
      { q: "ما هو الرمز (Token)؟", a: "أصل رقمي على البلوكشين", options: ["أصل رقمي على البلوكشين", "عملة مادية", "ورقة نقدية", "كلمة مرور"] },
      { q: "ماذا يعني ICO؟", a: "عرض العملة الأولي", options: ["عرض العملة الأولي", "منظمة العملات الدولية", "أمر تشفير داخلي", "خيار العملة عبر الإنترنت"] },
      { q: "ما هي دالة الهاش؟", a: "دالة تحول البيانات إلى حجم ثابت", options: ["دالة تحول البيانات إلى حجم ثابت", "كلمة مرور", "أداة تشفير", "رمز"] },
      { q: "أي منصة مشهورة بالعقود الذكية؟", a: "إيثريوم", options: ["إيثريوم", "بيتكوين", "ريبل", "لايتكوين"] },
      { q: "ما هو الغاز في إيثريوم؟", a: "رسوم تنفيذ المعاملات", options: ["رسوم تنفيذ المعاملات", "نوع من الرموز", "محفظة", "عقد"] },
      { q: "ما هو التعدين؟", a: "التحقق من المعاملات وإضافتها للبلوكشين", options: ["التحقق من المعاملات وإضافتها للبلوكشين", "إرسال العملات", "تخزين العملات", "تداول العملات"] },
      { q: "ما هي المحفظة الباردة؟", a: "تخزين العملات بدون اتصال بالإنترنت", options: ["تخزين العملات بدون اتصال بالإنترنت", "بورصة إلكترونية", "محفظة ساخنة", "محفظة موبايل"] },
      { q: "ماذا يلغي التمويل اللامركزي؟", a: "الوسطاء", options: ["الوسطاء", "المعاملات", "العقود الذكية", "الرموز"] },
      { q: "ما هو الكتلة في البلوكشين؟", a: "مجموعة معاملات مسجلة", options: ["مجموعة معاملات مسجلة", "محفظة", "نوع رمز", "عملة رقمية"] },
      { q: "من اخترع البيتكوين؟", a: "ساتوشي ناكاموتو", options: ["ساتوشي ناكاموتو", "فيتاليك بوتيرين", "إيلون ماسك", "تشارلي لي"] },
      { q: "ما هو السيولة في العملات الرقمية؟", a: "سهولة شراء وبيع الأصول", options: ["سهولة شراء وبيع الأصول", "قيمة الرمز", "محفظة العملات", "عرض الرموز"] },
      { q: "ما هي البورصة؟", a: "منصة لتداول العملات الرقمية", options: ["منصة لتداول العملات الرقمية", "محفظة العملات", "البلوكشين", "تجمع تعدين"] },
      { q: "ما هي التوكنوميكس؟", a: "اقتصاديات الرموز", options: ["اقتصاديات الرموز", "نوع من الرموز", "ميزة المحفظة", "مفهوم البلوكشين"] }
    ]
  };

  let lang = 'en';
  let currentQuestionIndex = 0;
  let score = 0;
  let unansweredQuestions = [];
  let questionOrder = [];
  const timeLimit = 10;
  let timerInterval = null;
  let isReviewingUnanswered = false;

  const correctSound = document.getElementById('correctSound');
  const wrongSound = document.getElementById('wrongSound');
  const bgMusic = document.getElementById('bgMusic');
  const monkeyImg = document.getElementById('monkey-img');

  const monkeyHappy = "https://i.imgur.com/4AiXzf8.gif"; // jumping monkey GIF
  const monkeySad = "https://i.imgur.com/qYLhIuE.gif";   // sad monkey GIF
  const monkeyNeutral = "https://i.imgur.com/0Xv9r1V.png"; // neutral monkey static

  const container = document.getElementById('container');
  const startBtn = document.getElementById('start-btn');
  const quizDiv = document.getElementById('quiz');
  const questionEl = document.getElementById('question');
  const answersEl = document.getElementById('answers');
  const timerEl = document.getElementById('timer');
  const progressEl = document.getElementById('progress');
  const resultEl = document.getElementById('result');
  const btnEn = document.getElementById('btn-en');
  const btnAr = document.getElementById('btn-ar');
  const musicControlBtn = document.getElementById('music-control');
  const gameTitle = document.getElementById('game-title');

  function shuffleArray(arr) {
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
  }

  function setLanguage(newLang) {
    lang = newLang;
    if (lang === 'ar') {
      container.style.direction = 'rtl';
      container.style.fontWeight = '700';
      gameTitle.textContent = 'لعبة ذكاء الكريبتو';
      startBtn.textContent = 'ابدأ اللعبة';
      musicControlBtn.textContent = bgMusic.paused ? 'تشغيل الموسيقى' : 'إيقاف الموسيقى';
      btnEn.style.backgroundColor = '#00796b';
      btnAr.style.backgroundColor = '#00bcd4';
    } else {
      container.style.direction = 'ltr';
      container.style.fontWeight = '700';
      gameTitle.textContent = 'Crypto IQ Game';
      startBtn.textContent = 'Start Game';
      musicControlBtn.textContent = bgMusic.paused ? 'Play Music' : 'Pause Music';
      btnEn.style.backgroundColor = '#00bcd4';
      btnAr.style.backgroundColor = '#00796b';
    }
    resetGame();
  }

  function resetGame() {
    score = 0;
    currentQuestionIndex = 0;
    unansweredQuestions = [];
    isReviewingUnanswered = false;
    questionOrder = [...Array(questions[lang].length).keys()];
    shuffleArray(questionOrder);
    resultEl.textContent = '';
    quizDiv.style.display = 'none';
    startBtn.style.display = 'inline-block';
    monkeyImg.src = monkeyNeutral;
    timerEl.textContent = '';
    progressEl.textContent = '';
    answersEl.innerHTML = '';
  }

  function startGame() {
    startBtn.style.display = 'none';
    quizDiv.style.display = 'block';
    score = 0;
    currentQuestionIndex = 0;
    unansweredQuestions = [];
    isReviewingUnanswered = false;
    monkeyImg.src = monkeyNeutral;
    showQuestion();
    bgMusic.play();
  }

  function showQuestion() {
    clearInterval(timerInterval);
    if (currentQuestionIndex >= questionOrder.length) {
      if (!isReviewingUnanswered && unansweredQuestions.length > 0) {
        // review unanswered questions
        isReviewingUnanswered = true;
        questionOrder = [...unansweredQuestions];
        unansweredQuestions = [];
        currentQuestionIndex = 0;
        alert(lang === 'ar' ? "الآن ستتم مراجعة الأسئلة التي لم تُجب عليها" : "Now reviewing unanswered questions.");
        showQuestion();
        return;
      }
      showResult();
      return;
    }
    const qIndex = questionOrder[currentQuestionIndex];
    const question = questions[lang][qIndex];
    questionEl.textContent = question.q;
    progressEl.textContent = `${lang === 'ar' ? 'السؤال' : 'Question'} ${currentQuestionIndex + 1} / ${questionOrder.length}`;
    answersEl.innerHTML = '';

    // Shuffle answers order
    const options = [...question.options];
    shuffleArray(options);

    options.forEach(opt => {
      const btn = document.createElement('button');
      btn.textContent = opt;
      btn.onclick = () => selectAnswer(opt, question.a);
      answersEl.appendChild(btn);
    });

    // Reset monkey image and timer
    monkeyImg.src = monkeyNeutral;
    startTimer();
  }

  function selectAnswer(selected, correct) {
    clearInterval(timerInterval);
    if (selected === correct) {
      score++;
      monkeyImg.src = monkeyHappy;
      correctSound.currentTime = 0;
      correctSound.play();
    } else {
      monkeyImg.src = monkeySad;
      wrongSound.currentTime = 0;
      wrongSound.play();
    }
    // Disable all buttons after answer
    [...answersEl.children].forEach(btn => btn.disabled = true);

    // Next question after short delay
    setTimeout(() => {
      currentQuestionIndex++;
      showQuestion();
    }, 1500);
  }

  function startTimer() {
    let timeLeft = timeLimit;
    timerEl.textContent = `${lang === 'ar' ? 'الوقت المتبقي' : 'Time left'}: ${timeLeft}s`;
    timerInterval = setInterval(() => {
      timeLeft--;
      timerEl.textContent = `${lang === 'ar' ? 'الوقت المتبقي' : 'Time left'}: ${timeLeft}s`;
      if (timeLeft <= 0) {
        clearInterval(timerInterval);
        unansweredQuestions.push(questionOrder[currentQuestionIndex]);
        currentQuestionIndex++;
        showQuestion();
      }
    }, 1000);
  }

  function showResult() {
    quizDiv.style.display = 'none';
    startBtn.style.display = 'inline-block';
    monkeyImg.src = monkeyNeutral;
    const totalQuestions = isReviewingUnanswered ? questionOrder.length : questions[lang].length;
    resultEl.textContent = lang === 'ar'
      ? `لقد أجبت على ${score} من أصل ${totalQuestions} أسئلة صحيحة.`
      : `You answered correctly ${score} out of ${totalQuestions} questions.`;
    if (unansweredQuestions.length > 0 && !isReviewingUnanswered) {
      // Safety check, but ideally won't happen here
      alert(lang === 'ar'
        ? 'بعض الأسئلة لم تتم مراجعتها بعد.'
        : 'Some unanswered questions remain.');
    }
  }

  // Language buttons
  btnEn.addEventListener('click', () => setLanguage('en'));
  btnAr.addEventListener('click', () => setLanguage('ar'));

  // Start button
  startBtn.addEventListener('click', () => startGame());

  // Music control
  musicControlBtn.addEventListener('click', () => {
    if (bgMusic.paused) {
      bgMusic.play();
      musicControlBtn.textContent = lang === 'ar' ? 'إيقاف الموسيقى' : 'Pause Music';
    } else {
      bgMusic.pause();
      musicControlBtn.textContent = lang === 'ar' ? 'تشغيل الموسيقى' : 'Play Music';
    }
  });

  // Initialize default language
  setLanguage('en');
</script>
</body>
</html>
