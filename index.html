<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Crypto Mastery Quiz</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #1f1c2c, #928dab);
    color: #eee;
    margin: 0; padding: 0;
    display: flex; justify-content: center; align-items: center;
    height: 100vh;
    direction: ltr;
  }
  body.rtl {
    direction: rtl;
    font-family: 'Arial', sans-serif;
  }
  #quiz-container {
    background: rgba(30, 30, 40, 0.95);
    border-radius: 12px;
    box-shadow: 0 0 20px #5f7aebaa;
    max-width: 800px;
    width: 95%;
    padding: 30px;
    text-align: center;
  }
  h1 {
    margin-bottom: 10px;
    color: #7d90ff;
  }
  #question {
    font-size: 1.3rem;
    margin: 20px 0;
    min-height: 80px;
  }
  .option {
    background: #393c59;
    margin: 10px 0;
    padding: 12px 20px;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.3s, transform 0.2s;
  }
  .option:hover {
    background: #5860ff;
    transform: scale(1.05);
  }
  .correct {
    background: #3cba54 !important;
  }
  .wrong {
    background: #db4437 !important;
  }
  #score, #progress, #timer {
    margin-top: 20px;
    font-size: 1.1rem;
  }
  #next-btn {
    margin-top: 25px;
    background: #7d90ff;
    border: none;
    color: #fff;
    padding: 12px 25px;
    font-size: 1rem;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.3s;
  }
  #next-btn:disabled {
    background: #555;
    cursor: not-allowed;
  }
  #next-btn:hover:enabled {
    background: #4e5edd;
  }
  #lang-select {
    margin-bottom: 20px;
    font-size: 1rem;
    padding: 6px 12px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
  }
</style>
</head>
<body>
<div id="quiz-container">
  <select id="lang-select" aria-label="Select Language">
    <option value="en">🇬🇧 English</option>
    <option value="ar">🇸🇦 العربية</option>
  </select>
  <h1 id="quiz-title">Crypto Mastery Quiz</h1>
  <div id="question">Loading question...</div>
  <div id="options"></div>
  <div id="timer"></div>
  <button id="next-btn" disabled>Next</button>
  <div id="progress"></div>
  <div id="score"></div>
</div>

<audio id="sound-correct" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>
<audio id="sound-wrong" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"></audio>

<script>
(() => {
  const questionsData = {
    en: [
      {question:"What does a zk-SNARK provide in blockchain?",options:["Privacy-preserving zero-knowledge proof","A mining reward system","A type of wallet","Staking contract"],answer:"Privacy-preserving zero-knowledge proof"},
      {question:"What is a flash loan attack?",options:["Manipulating DeFi via instant loans","Mining pool overload","Gas fee manipulation","NFT duplication"],answer:"Manipulating DeFi via instant loans"},
      {question:"What is the main function of Chainlink?",options:["Providing oracles for smart contracts","Hosting NFTs","Staking service","Layer 2 scaling"],answer:"Providing oracles for smart contracts"},
      {question:"What is a Merkle Tree used for in blockchain?",options:["Efficient data verification","Token minting","Smart contract execution","Reward calculation"],answer:"Efficient data verification"},
      {question:"What is slippage in crypto trading?",options:["Difference between expected and actual price","Gas fee delay","Token inflation","Liquidity pool bug"],answer:"Difference between expected and actual price"},
      {question:"What does DeFi stand for?",options:["Decentralized Finance","Digital Finance","Distributed File","Direct Funding"],answer:"Decentralized Finance"},
      {question:"What is a DAO?",options:["Decentralized Autonomous Organization","Digital Asset Option","Data Access Object","Decentralized Algorithmic Oracle"],answer:"Decentralized Autonomous Organization"},
      {question:"What is the purpose of a smart contract?",options:["Self-executing contract on blockchain","Legal contract scanned","Crypto wallet","Mining hardware"],answer:"Self-executing contract on blockchain"},
      {question:"What does ‘staking’ mean in crypto?",options:["Locking tokens to support network and earn rewards","Mining coins","Trading rapidly","Buying NFTs"],answer:"Locking tokens to support network and earn rewards"},
      {question:"Which consensus algorithm uses ‘proof of work’?",options:["Bitcoin","Ethereum 2.0","Cardano","Polkadot"],answer:"Bitcoin"},
      {question:"What is a ‘nonce’ in blockchain mining?",options:["A number used once to vary the hash","A type of wallet","A smart contract","A token standard"],answer:"A number used once to vary the hash"},
      {question:"What is the function of a ‘hash’ in blockchain?",options:["Data fingerprint for integrity","Token exchange rate","Gas fee","Wallet address"],answer:"Data fingerprint for integrity"},
      {question:"What is ‘liquidity mining’?",options:["Providing liquidity to DeFi pools for rewards","Mining bitcoins","Token burning","NFT auction"],answer:"Providing liquidity to DeFi pools for rewards"},
      {question:"What are ERC-20 tokens?",options:["Ethereum fungible tokens standard","Bitcoin tokens","NFT standard","DeFi loan tokens"],answer:"Ethereum fungible tokens standard"},
      {question:"What does ‘gas fee’ mean?",options:["Payment to miners for transaction processing","Penalty fee","Staking fee","Token price"],answer:"Payment to miners for transaction processing"},
      {question:"What is a ‘cold wallet’?",options:["Offline cryptocurrency wallet","Hot wallet","Exchange account","Smart contract"],answer:"Offline cryptocurrency wallet"},
      {question:"What is ‘impermanent loss’?",options:["Loss from providing liquidity due to price changes","Permanent wallet hack","Mining failure","Failed transaction"],answer:"Loss from providing liquidity due to price changes"},
      {question:"What is a ‘hashrate’?",options:["Mining power per second","Wallet balance","Token supply","Gas limit"],answer:"Mining power per second"},
      {question:"What does NFT stand for?",options:["Non-Fungible Token","New Financial Transaction","Network File Transfer","Node Functional Token"],answer:"Non-Fungible Token"},
      {question:"What is a ‘51% attack’?",options:["Control of majority mining power to manipulate blockchain","Slashing penalty","Token inflation","Smart contract bug"],answer:"Control of majority mining power to manipulate blockchain"},
      {question:"What does ‘fork’ mean in blockchain?",options:["Network split creating two versions","Token swap","Wallet backup","Mining hardware upgrade"],answer:"Network split creating two versions"},
      {question:"What is ‘yield farming’?",options:["Earning rewards by lending or staking crypto","Mining yield","Token creation","Wallet backup"],answer:"Earning rewards by lending or staking crypto"},
      {question:"What is a ‘token burn’?",options:["Permanently removing tokens from circulation","Creating new tokens","Transferring tokens","Smart contract upgrade"],answer:"Permanently removing tokens from circulation"},
      {question:"What is ‘sharding’ in blockchain?",options:["Splitting database for scalability","Mining method","Wallet type","Token standard"],answer:"Splitting database for scalability"},
      {question:"What is ‘Layer 2’ solution?",options:["Off-chain scaling method","Token","Smart contract","Exchange"],answer:"Off-chain scaling method"},
    ],
    ar: [
      {question:"ماذا توفر zk-SNARK في البلوكشين؟",options:["إثبات معرفة صفرية يحافظ على الخصوصية","نظام مكافآت التعدين","نوع من المحفظة","عقد الرهان"],answer:"إثبات معرفة صفرية يحافظ على الخصوصية"},
      {question:"ما هو هجوم القرض الفلاش؟",options:["التلاعب بـ DeFi عبر قروض فورية","زيادة تحميل مجموعة التعدين","التلاعب برسوم الغاز","تكرار NFT"],answer:"التلاعب بـ DeFi عبر قروض فورية"},
      {question:"ما هي الوظيفة الرئيسية لـ Chainlink؟",options:["توفير الأوراكل للعقود الذكية","استضافة NFTs","خدمة الرهان","توسيع الطبقة الثانية"],answer:"توفير الأوراكل للعقود الذكية"},
      {question:"ما هو استخدام شجرة ميركل في البلوكشين؟",options:["التحقق الفعال من البيانات","سك التوكنات","تنفيذ العقود الذكية","حساب المكافآت"],answer:"التحقق الفعال من البيانات"},
      {question:"ما هو الانزلاق السعري في تداول العملات الرقمية؟",options:["الفرق بين السعر المتوقع والفعلي","تأخير رسوم الغاز","تضخم التوكن","خلل في مجمع السيولة"],answer:"الفرق بين السعر المتوقع والفعلي"},
      {question:"ماذا تعني DeFi؟",options:["التمويل اللامركزي","التمويل الرقمي","الملف الموزع","التمويل المباشر"],answer:"التمويل اللامركزي"},
      {question:"ما هو DAO؟",options:["منظمة مستقلة لامركزية","خيار الأصول الرقمية","كائن الوصول إلى البيانات","أوراكل خوارزمي لامركزي"],answer:"منظمة مستقلة لامركزية"},
      {question:"ما هو الهدف من العقد الذكي؟",options:["عقد ينفذ نفسه على البلوكشين","عقد قانوني ممسوح ضوئياً","محفظة عملات رقمية","أجهزة التعدين"],answer:"عقد ينفذ نفسه على البلوكشين"},
      {question:"ماذا يعني ‘الرهان’ في العملات الرقمية؟",options:["تجميد التوكنات لدعم الشبكة وكسب المكافآت","تعدين العملات","تداول سريع","شراء NFTs"],answer:"تجميد التوكنات لدعم الشبكة وكسب المكافآت"},
      {question:"أي خوارزمية توافق تستخدم ‘إثبات العمل’؟",options:["بيتكوين","إيثيريوم 2.0","كاردانو","بولكادوت"],answer:"بيتكوين"},
      {question:"ما هو ‘nonce’ في تعدين البلوكشين؟",options:["رقم يستخدم مرة واحدة لتغيير الهاش","نوع من المحافظ","عقد ذكي","معيار توكن"],answer:"رقم يستخدم مرة واحدة لتغيير الهاش"},
      {question:"ما وظيفة ‘هاش’ في البلوكشين؟",options:["بصمة بيانات للتحقق","سعر صرف التوكن","رسوم الغاز","عنوان المحفظة"],answer:"بصمة بيانات للتحقق"},
      {question:"ما هو ‘تعدين السيولة’؟",options:["توفير السيولة لمجمعات DeFi مقابل مكافآت","تعدين بيتكوين","حرق التوكن","مزاد NFT"],answer:"توفير السيولة لمجمعات DeFi مقابل مكافآت"},
      {question:"ما هي توكنات ERC-20؟",options:["معيار التوكنات القابلة للاستبدال على إيثيريوم","توكنات بيتكوين","معيار NFT","توكنات قرض DeFi"],answer:"معيار التوكنات القابلة للاستبدال على إيثيريوم"},
      {question:"ماذا يعني ‘رسوم الغاز’؟",options:["دفع للمعدنين لمعالجة المعاملة","رسوم جزائية","رسوم الرهان","سعر التوكن"],answer:"دفع للمعدنين لمعالجة المعاملة"},
      {question:"ما هي ‘محفظة باردة’؟",options:["محفظة عملات رقمية غير متصلة بالإنترنت","محفظة ساخنة","حساب بورصة","عقد ذكي"],answer:"محفظة عملات رقمية غير متصلة بالإنترنت"},
      {question:"ما هو ‘الخسارة غير الدائمة’؟",options:["خسارة من توفير السيولة بسبب تغيرات السعر","اختراق دائم للمحفظة","فشل التعدين","معاملة فاشلة"],answer:"خسارة من توفير السيولة بسبب تغيرات السعر"},
      {question:"ما هو ‘معدل الهاش’؟",options:["قوة التعدين في الثانية","رصيد المحفظة","عرض التوكن","حد الغاز"],answer:"قوة التعدين في الثانية"},
      {question:"ماذا يعني NFT؟",options:["توكن غير قابل للاستبدال","معاملة مالية جديدة","نقل ملف الشبكة","توكن وظيفي للعقد"],answer:"توكن غير قابل للاستبدال"},
      {question:"ما هو هجوم ‘51%’؟",options:["السيطرة على غالبية قوة التعدين للتلاعب بالبلوكشين","عقوبة القطع","تضخم التوكن","خلل العقد الذكي"],answer:"السيطرة على غالبية قوة التعدين للتلاعب بالبلوكشين"},
      {question:"ماذا يعني ‘فرع’ (Fork) في البلوكشين؟",options:["انقسام الشبكة لإنشاء نسختين","تبديل التوكن","نسخ احتياطي للمحفظة","ترقية معدات التعدين"],answer:"انقسام الشبكة لإنشاء نسختين"},
      {question:"ما هو ‘زراعة العوائد’؟",options:["كسب مكافآت عبر إقراض أو رهن العملات","عائد التعدين","إنشاء توكنات","نسخ احتياطي للمحفظة"],answer:"كسب مكافآت عبر إقراض أو رهن العملات"},
      {question:"ما هو ‘حرق التوكنات’؟",options:["إزالة التوكنات نهائياً من التداول","إنشاء توكنات جديدة","نقل التوكنات","ترقية العقد الذكي"],answer:"إزالة التوكنات نهائياً من التداول"},
      {question:"ما هو ‘التقسيم’ (Sharding) في البلوكشين؟",options:["تقسيم قاعدة البيانات لتحسين الأداء","طريقة تعدين","نوع المحفظة","معيار التوكن"],answer:"تقسيم قاعدة البيانات لتحسين الأداء"},
      {question:"ما هو حل ‘الطبقة الثانية’؟",options:["طريقة توسيع خارج السلسلة","توكن","عقد ذكي","بورصة"],answer:"طريقة توسيع خارج السلسلة"},
    ]
  };

  const quizTitle = document.getElementById('quiz-title');
  const questionEl = document.getElementById('question');
  const optionsEl = document.getElementById('options');
  const nextBtn = document.getElementById('next-btn');
  const scoreEl = document.getElementById('score');
  const progressEl = document.getElementById('progress');
  const timerEl = document.getElementById('timer');
  const langSelect = document.getElementById('lang-select');
  const soundCorrect = document.getElementById('sound-correct');
  const soundWrong = document.getElementById('sound-wrong');
  const body = document.body;

  let lang = 'en';
  let questions = [];
  let currentIndex = 0;
  let score = 0;
  let timerInterval;
  let timeLeft = 10;
  const unansweredQuestions = [];

  function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  function loadQuestions() {
    questions = [...questionsData[lang]];
    shuffleArray(questions);
  }

  function startTimer() {
    timeLeft = 10;
    timerEl.textContent = (lang === 'en' ? 'Time Left: ' : 'الوقت المتبقي: ') + timeLeft + 's';
    timerInterval = setInterval(() => {
      timeLeft--;
      timerEl.textContent = (lang === 'en' ? 'Time Left: ' : 'الوقت المتبقي: ') + timeLeft + 's';
      if (timeLeft <= 0) {
        clearInterval(timerInterval);
        markUnanswered();
        nextBtn.disabled = false;
        nextBtn.focus();
      }
    }, 1000);
  }

  function showQuestion() {
    nextBtn.disabled = true;
    timerEl.style.color = '#eee';
    if(currentIndex >= questions.length && unansweredQuestions.length > 0) {
      // Re-queue unanswered questions after main questions finish
      questions = [...unansweredQuestions];
      unansweredQuestions.length = 0;
      currentIndex = 0;
    }

    if (currentIndex >= questions.length) {
      finishQuiz();
      return;
    }
    const q = questions[currentIndex];
    questionEl.textContent = q.question;
    optionsEl.innerHTML = '';
    q.options.forEach(opt => {
      const optionDiv = document.createElement('div');
      optionDiv.classList.add('option');
      optionDiv.textContent = opt;
      optionDiv.tabIndex = 0;
      optionDiv.setAttribute('role', 'button');
      optionDiv.setAttribute('aria-pressed', 'false');
      optionDiv.addEventListener('click', () => selectOption(optionDiv, opt));
      optionDiv.addEventListener('keydown', e => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          selectOption(optionDiv, opt);
        }
      });
      optionsEl.appendChild(optionDiv);
    });
    progressEl.textContent = (lang === 'en' ? `Question ${currentIndex + 1} of ${questions.length}` : `السؤال ${currentIndex + 1} من ${questions.length}`);
    scoreEl.textContent = (lang === 'en' ? `Score: ${score}` : `النقاط: ${score}`);
    startTimer();
  }

  function selectOption(optionDiv, selectedOption) {
    clearInterval(timerInterval);
    nextBtn.disabled = false;
    // Prevent multiple selections
    if (optionsEl.querySelector('.correct') || optionsEl.querySelector('.wrong')) return;

    const correctAnswer = questions[currentIndex].answer;
    if (selectedOption === correctAnswer) {
      optionDiv.classList.add('correct');
      score++;
      soundCorrect.play();
    } else {
      optionDiv.classList.add('wrong');
      soundWrong.play();
      // Show correct answer
      Array.from(optionsEl.children).forEach(opt => {
        if (opt.textContent === correctAnswer) {
          opt.classList.add('correct');
        }
      });
    }
    scoreEl.textContent = (lang === 'en' ? `Score: ${score}` : `النقاط: ${score}`);
  }

  function markUnanswered() {
    // Highlight correct answer
    const correctAnswer = questions[currentIndex].answer;
    Array.from(optionsEl.children).forEach(opt => {
      if (opt.textContent === correctAnswer) {
        opt.classList.add('correct');
      }
    });
    unansweredQuestions.push(questions[currentIndex]);
    timerEl.style.color = '#f44336';
  }

  function finishQuiz() {
    questionEl.textContent = lang === 'en' ? `Quiz finished! Your score: ${score} / ${questions.length + unansweredQuestions.length}` : `انتهى الاختبار! نقاطك: ${score} من ${questions.length + unansweredQuestions.length}`;
    optionsEl.innerHTML = '';
    timerEl.textContent = '';
    progressEl.textContent = '';
    nextBtn.disabled = true;
  }

  nextBtn.addEventListener('click', () => {
    currentIndex++;
    showQuestion();
  });

  langSelect.addEventListener('change', () => {
    lang = langSelect.value;
    if(lang === 'ar') {
      body.classList.add('rtl');
      quizTitle.textContent = 'اختبار التشفير المتقدم';
      nextBtn.textContent = 'التالي';
    } else {
      body.classList.remove('rtl');
      quizTitle.textContent = 'Crypto Mastery Quiz';
      nextBtn.textContent = 'Next';
    }
    score = 0;
    currentIndex = 0;
    unansweredQuestions.length = 0;
    loadQuestions();
    showQuestion();
  });

  // Initialize
  loadQuestions();
  showQuestion();

})();
</script>
</body>
</html>
